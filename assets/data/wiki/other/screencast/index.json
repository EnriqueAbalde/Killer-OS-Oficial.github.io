{"hash":"61ad9d5b764ed9f21a913b83899aaf41331df145","data":{"markdownPage":{"id":"9202fb330b997618c3b52dd479bc1c2f","title":"Screencast","description":"","date":null,"date_up":"13.08.2020","path":"/wiki/other/screencast/","timeToRead":4,"content":"<h1 id=\"screencast-работа-с-видеоаудио\"><a href=\"#screencast-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE%D0%B0%D1%83%D0%B4%D0%B8%D0%BE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Screencast, работа с видео/аудио</h1>\n<h2 id=\"параметры-записи\"><a href=\"#%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8B-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Параметры записи</h2>\n<ul>\n<li>Pavucontrol, 46% микрофон.</li>\n<li>Запись simplescreenrecorder: MKV, H.264, rate 20, superfast, vorbis 128.</li>\n<li>Audacity: удаляем шумы(дважды), улучшаем звук.</li>\n<li>ffmpeg: заменяем аудио дорожку.</li>\n<li>ffmpeg: перекодируем в mp4, 1080p, 30 кадров, bit rate 128k, если нужно ускоряем на 20%.</li>\n<li>ffmpeg: накладываем 2 аудио дорожку, зацикливаем и понижаем звук.</li>\n<li>Обрезаем, если нужно.</li>\n</ul>\n<h2 id=\"audacity\"><a href=\"#audacity\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Audacity</h2>\n<ul>\n<li>Выделить фрагмент без звука, Эффекты-Noise Reduction-создать модель шума.</li>\n<li>Двойной клик на дорожке(выделить всю), Эффекты-Noise Reduction-ок(в 2 этапа).</li>\n<li>Нормализация.</li>\n<li>Если необходимо усиливаем звук Дб.</li>\n</ul>\n<h3 id=\"изменяем-голос\"><a href=\"#%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D0%BC-%D0%B3%D0%BE%D0%BB%D0%BE%D1%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Изменяем голос</h3>\n<ul>\n<li>Двойной клик на дорожке(выделить всю), Эффекты-Смена высоты тона. -15, ок.</li>\n<li>Файл-экспорт-как wav.</li>\n</ul>\n<h2 id=\"замена-аудио-ffmpeg\"><a href=\"#%D0%B7%D0%B0%D0%BC%D0%B5%D0%BD%D0%B0-%D0%B0%D1%83%D0%B4%D0%B8%D0%BE-ffmpeg\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Замена аудио ffmpeg</h2>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i input.mp4 -i good.wav -map <span class=\"token number\">0</span>:0 -map <span class=\"token number\">1</span>:0 -c copy output.mp4\n\nffmpeg -i input.mp4 -i input.wav -c:a aac -vcodec copy -map <span class=\"token number\">0</span>:0 -map <span class=\"token number\">1</span>:0 output.mp4</code></pre>\n<p>AvidemuxQT.</p>\n<ul>\n<li>Открыть видео.</li>\n<li>Аудио-Выбрать дорожку.</li>\n<li>Отключаем 1 дорожку по умолчанию.</li>\n<li>На 2 дорожку добавляем отредактированый в Audacity wav файл.</li>\n<li>Если нужно используем сдвиг.</li>\n</ul>\n<h2 id=\"ffmpeg\"><a href=\"#ffmpeg\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ffmpeg</h2>\n<p>Обрезка. Нужно выщитывать <code>-t</code>.</p>\n<p>Вырезать 5 мин.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -ss 01:09:00 -t 00:05:00 -i arch.mkv -c:v copy -c:a copy out.mkv</code></pre>\n<p>Обрезаем последние 2 сек. из исходника в 8 сек.(00:00:08).</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -ss 00:00:00 -i test.mkv -c copy -t 00:00:06 test2.mkv</code></pre>\n<p>С первой минуты по вторую(фрагмент с середины).</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -ss 00:01:00 -i video.mp4 -to 00:02:00 -c copy -copyts out.mp4</code></pre>\n<p>Первые 4 сек.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i video.mp4 -ss 00:00:04 -c copy out.mp4</code></pre>\n<p>Ускорение.</p>\n<ul>\n<li>Ускорение в 2 раза: <code>ffmpeg -i arch.mp4 -vf \"setpts=0.5*PTS\" speed.mp4</code></li>\n<li>Ускорение в 3 раза: <code>ffmpeg -i arch.mp4 -vf \"setpts=1/3*PTS\" speed.mp4</code></li>\n<li>Ускорение в 5 раз: <code>ffmpeg -i arch.mp4 -vf \"setpts=1/5*PTS\" speed.mp4</code></li>\n<li>Замедление в 5 раз: <code>ffmpeg -i arch.mp4 -vf \"setpts=1*5*PTS\" out.mp4</code></li>\n<li>Убрать аудио: -an</li>\n<li>Убрать видео: -vn</li>\n<li>Сохранить оригинальные кодеки: -c copy</li>\n<li>Битрейт аудио: -b:a (-b:a 320k)</li>\n<li>Битрейт видео: -b:v (-b:v 16M)</li>\n<li>Количество кадров fps: -r (-r 25)</li>\n<li>Разрешение видео: -s (-s 1280x720)</li>\n</ul>\n<p>Перед ускорением нужно убрать аудио <code>-an</code>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i arch.mkv -r <span class=\"token number\">30</span> -s 1920x1080 out.mp4\n\nffmpeg -i out.mp4 -vf <span class=\"token string\">\"setpts=0.8*PTS\"</span> speed.mp4</code></pre>\n<p>Или комплексное, примерно на 20% <code>atempo=1/setpts</code>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i arch.mkv -filter_complex <span class=\"token string\">\"[0:v]setpts=0.8*PTS[v];[0:a]atempo=1.25[a]\"</span> -map <span class=\"token string\">\"[v]\"</span> -map <span class=\"token string\">\"[a]\"</span> -b:a 128k -r <span class=\"token number\">30</span> -s 1920x1080 speed.mp4</code></pre>\n<p>Мозайка.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg\n  -i <span class=\"token number\">1</span>.avi -i <span class=\"token number\">2</span>.avi -i <span class=\"token number\">3</span>.avi -i <span class=\"token number\">4</span>.avi\n  -filter_complex <span class=\"token string\">\"\n    nullsrc=size=640x480 [base];\n    [0:v] setpts=PTS-STARTPTS, scale=320x240 [upperleft];\n    [1:v] setpts=PTS-STARTPTS, scale=320x240 [upperright];\n    [2:v] setpts=PTS-STARTPTS, scale=320x240 [lowerleft];\n    [3:v] setpts=PTS-STARTPTS, scale=320x240 [lowerright];\n    [base][upperleft] overlay=shortest=1 [tmp1];\n    [tmp1][upperright] overlay=shortest=1:x=320 [tmp2];\n    [tmp2][lowerleft] overlay=shortest=1:y=240 [tmp3];\n    [tmp3][lowerright] overlay=shortest=1:x=320:y=240\n  \"</span>\n  -c:v libx264 output.mkv\n\nffmpeg -i <span class=\"token number\">1</span>.avi -i <span class=\"token number\">2</span>.avi -i <span class=\"token number\">3</span>.avi -i <span class=\"token number\">4</span>.avi -filter_complex <span class=\"token string\">\"nullsrc=size=640x480 [base]; [0:v] setpts=PTS-STARTPTS, scale=320x240 [upperleft]; [1:v] setpts=PTS-STARTPTS, scale=320x240 [upperright]; [2:v] setpts=PTS-STARTPTS, scale=320x240 [lowerleft]; [3:v] setpts=PTS-STARTPTS, scale=320x240 [lowerright]; [base][upperleft] overlay=shortest=1 [tmp1]; [tmp1][upperright] overlay=shortest=1:x=320 [tmp2]; [tmp2][lowerleft] overlay=shortest=1:y=240 [tmp3]; [tmp3][lowerright] overlay=shortest=1:x=320:y=240\"</span> -c:v libx264 output.mkv</code></pre>\n<h3 id=\"наложение-аудио\"><a href=\"#%D0%BD%D0%B0%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B0%D1%83%D0%B4%D0%B8%D0%BE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Наложение аудио</h3>\n<p>Проще заменить дорожку, или наложить в <code>avidemux</code>, если нужно применяем сдвиг в милесекундах (-2000), 2 секунды.</p>\n<p>Опция <code>shortest</code> — если аудио и видео на входе имеют разную длительность по времени, то результат будет иметь длительность самого короткого компонента.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i видео.mp4 -i аудио.wav -c:v copy -c:a copy -shortest результат.mkv\n\nmencoder -audiofile аудио.wav видео.mp4 -o результат.mp4 -ovc copy -oac copy</code></pre>\n<p>Наложение второй аудио дорожки и понижениие громкости.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i video4.mp4 -i wave.mp3 -filter_complex <span class=\"token string\">\"[0:a]volume=1[a1];[1:a]volume=0.2[a2];[a1][a2]amerge=inputs=2\"</span> -c:v copy -c:a libmp3lame -shortest out_mp3.mp4</code></pre>\n<p>Зацикливаем 2 аудио дорожку и понижаем звук, т.к. применили <code>-stream_loop</code>, то и <code>-shortest</code> нужен.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -i video4.mp4 -stream_loop -1 -i bla.mp3 -filter_complex <span class=\"token string\">\"[0:a]volume=1[a1];[1:a]volume=0.03[a2];[a1][a2]amerge=inputs=2\"</span> -c:v copy -c:a libmp3lame -shortest out_mp3.mp4</code></pre>\n<h2 id=\"stream-restreamio\"><a href=\"#stream-restreamio\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Stream. restream.io</h2>\n<pre class=\"language-bash\"><code class=\"language-bash\">Live Stream <span class=\"token punctuation\">(</span>3000kbps<span class=\"token punctuation\">)</span>\nrtmp://live.restream.io/live/key\nflv, libx264, b/rate <span class=\"token number\">3000</span>, mp3 <span class=\"token number\">128</span></code></pre>\n<h2 id=\"скрипты-bin\"><a href=\"#%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B-bin\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Скрипты <code>~/.bin</code></h2>\n<ul>\n<li>stream - стриминг через restream.io.</li>\n<li>castm - запись.</li>\n<li>cast - запись без аудио.</li>\n</ul>\n<h2 id=\"kdenlive\"><a href=\"#kdenlive\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Kdenlive</h2>\n<ul>\n<li>Настроить-Параметры проекта по умолчанию-HD 1080i 30fps.</li>\n</ul>\n<p>Или.</p>\n<ul>\n<li>Настроить-Параметры проекта по умолчанию-HD 1080p 60fps.</li>\n<li>Настроить-Окружение-Потоков обработки - 2.</li>\n<li>Сборка. Generic, MP4 (H264/AAC).</li>\n</ul>\n<p>Ускоряем сборку на MP4 (H264/AAC). <code>Сборка-создать сценарий</code>. Отредактировать скрипт. Изменить <code>preset=faster</code> на <code>preset=ultrafast</code>. Проверить скорость работы скрипта до и после.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">time</span> ./script001.sh</code></pre>\n<p>Размер выходного файла.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">du</span> -h video.mp4</code></pre>\n<p>Результат теста. (исходник video.mkv 1:21 2,5Mb).</p>\n<ul>\n<li>HD 1080i 30fps MP4 (H264/AAC) - 7:46 4,2 Mb</li>\n<li>HD 1080p 60fps MP4 (H264/AAC) faster - 14:22 5,6Mb</li>\n<li>HD 1080p 30fps MP4 (H264/AAC) faster - 8:24 4,1Mb</li>\n<li>+HD 1080p 30fps MP4 (H264/AAC) ultrafast - 6:34 8.2Mb</li>\n<li>HD 1080p 30fps webm - 7:58 9.9Mb</li>\n</ul>\n","sidebar":"wiki","next":"","prev":"","headings":[{"depth":1,"value":"Screencast, работа с видео/аудио","anchor":"#screencast-работа-с-видеоаудио"},{"depth":2,"value":"Параметры записи","anchor":"#параметры-записи"},{"depth":2,"value":"Audacity","anchor":"#audacity"},{"depth":3,"value":"Изменяем голос","anchor":"#изменяем-голос"},{"depth":2,"value":"Замена аудио ffmpeg","anchor":"#замена-аудио-ffmpeg"},{"depth":2,"value":"Ffmpeg","anchor":"#ffmpeg"},{"depth":3,"value":"Наложение аудио","anchor":"#наложение-аудио"},{"depth":2,"value":"Stream. restream.io","anchor":"#stream-restreamio"},{"depth":2,"value":"Скрипты ~/.bin","anchor":"#скрипты-bin"},{"depth":2,"value":"Kdenlive","anchor":"#kdenlive"}]},"allMarkdownPage":{"edges":[{"node":{"path":"/wiki/changelog/bspwm-0-3-1/","title":"Bspwm v0.3.1"}},{"node":{"path":"/wiki/changelog/xfce-1-8-0/","title":"Xfce v1.8.0"}},{"node":{"path":"/wiki/changelog/openbox-1-3-0/","title":"Openbox v1.3.0"}},{"node":{"path":"/wiki/changelog/bspwm-0-1-0/","title":"Bspwm v0.1.0"}},{"node":{"path":"/wiki/changelog/xfce-1-6-0/","title":"Xfce v1.6.0"}},{"node":{"path":"/wiki/changelog/openbox-1-2-0/","title":"Openbox v1.2.0"}},{"node":{"path":"/wiki/changelog/i3-1-0-0/","title":"I3 v1.0.0"}},{"node":{"path":"/wiki/changelog/xfce-1-5-0/","title":"Xfce v1.5.0"}},{"node":{"path":"/wiki/changelog/xfce-1-4-0/","title":"Xfce v1.4.0"}},{"node":{"path":"/wiki/changelog/bspwm-0-0-1/","title":"Bspwm v0.0.1"}},{"node":{"path":"/wiki/changelog/xfce-1-3-0/","title":"Xfce v1.3.0"}},{"node":{"path":"/wiki/changelog/openbox-2-1/","title":"Openbox,i3 v2.1"}},{"node":{"path":"/wiki/changelog/xfce-1-2-0/","title":"Xfce v1.2.0"}},{"node":{"path":"/wiki/changelog/xfce-1-1-0/","title":"Xfce v1.1.0"}},{"node":{"path":"/wiki/changelog/openbox-2-2/","title":"Openbox,i3 v2.2"}},{"node":{"path":"/wiki/changelog/openbox-2-0-0/","title":"Openbox,i3 v2.0.0"}},{"node":{"path":"/wiki/changelog/openbox-1-0-0/","title":"Openbox v1.0.0"}},{"node":{"path":"/wiki/changelog/xfce-1-0-0/","title":"Xfce v1.0.0"}},{"node":{"path":"/wiki/changelog/default/","title":"Xfce v1.0.0"}},{"node":{"path":"/wiki/wm/bspwm/","title":"Ctlos Bspwm"}},{"node":{"path":"/wiki/packages/other-pkg/","title":"Доп. программы"}},{"node":{"path":"/wiki/packages/iwd/","title":"Iwd wifi"}},{"node":{"path":"/wiki/other/screencast/","title":"Screencast"}},{"node":{"path":"/wiki/other/notes/","title":"Заметки"}},{"node":{"path":"/wiki/other/grub-uefi/","title":"Grub UEFI"}},{"node":{"path":"/wiki/other/gnupg/","title":"Gnupg"}},{"node":{"path":"/wiki/other/git-start/","title":"Git Start"}},{"node":{"path":"/wiki/other/ctlosiso/","title":"Ctlos iso"}},{"node":{"path":"/wiki/install/pkg-manager/","title":"Менеджеры пакетов"}},{"node":{"path":"/wiki/install/next-install/","title":"После установки"}},{"node":{"path":"/wiki/install/install-ctlos/","title":"Установка Ctlos"}},{"node":{"path":"/wiki/install/ctlos-repo/","title":"Репозиторий ctlos"}},{"node":{"path":"/wiki/config/videocfg/","title":"Видео драйвера"}},{"node":{"path":"/wiki/config/trouble/","title":"Решение проблем"}},{"node":{"path":"/wiki/config/ssh/","title":"Настройка ssh"}},{"node":{"path":"/wiki/config/recomend/","title":"Рекомендации"}},{"node":{"path":"/wiki/config/autologin/","title":"Автологин"}},{"node":{"path":"/wiki/changelog/","title":"Changelog"}},{"node":{"path":"/wiki/btrfs/btrfs-part2/","title":"Btrfs перенос"}},{"node":{"path":"/wiki/btrfs/btrfs-part1/","title":"Instalación de btrfs"}},{"node":{"path":"/wiki/backup/timeshift-rsync/","title":"Timeshift, rsync"}},{"node":{"path":"/wiki/backup/squashfs/","title":"Squashfs"}},{"node":{"path":"/wiki/backup/netcat/","title":"Netcat, ssh, rsync"}},{"node":{"path":"/wiki/whois/","title":"Brevemente sobre Killer-OS Linux"}},{"node":{"path":"/wiki/","title":"Killer-OS Linux Wiki"}}]}},"context":{}}